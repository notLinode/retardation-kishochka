import openai

def get_response(akash_api_key: str, prompt: str) -> str:
    try:
        client = openai.OpenAI(
            api_key=akash_api_key,
            base_url="https://chatapi.akash.network/api/v1"
        )

        response = client.chat.completions.create(
            model="Meta-Llama-3-3-70B-Instruct",
            messages = [
                {
                    "role": "user",
                    "content": prompt
                }
            ],
            timeout=7
        )

        return response.choices[0].message.content
    except:
        return "üö´ –≤—ã –¥–∞—É–Ω"
    

async def generate_automessage(akash_api_key: str, recent_messages: list[str], stylized_bot_messages: list[str]) -> str:
    response: str
    
    prompt: str = "–¢—ã - —É—á–∞—Å—Ç–Ω–∏–∫ —Ç—É–ø–æ–≥–æ —á–∞—Ç–∞ –≤ –¥–∏—Å–∫–æ—Ä–¥–µ –ø–æ–¥ –Ω–∏–∫–æ–º megainvalid2475 (–º–µ–≥–∞–∏–Ω–≤–∞–ª–∏–¥). –°–µ—Ä–≤–µ—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è KORB7 (–ö–û–†–ë7). –£—á–∞—Å—Ç–Ω–∏–∫–∏ –ö–û–†–ë7 –Ω–µ–Ω–∞–≤–∏–¥—è—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ö–û–†–ë8 –∏ –ö–û–†–ë9. "
    prompt += f"–°–µ–π—á–∞—Å —Ç—ã —É–≤–∏–¥–∏—à—å {len(recent_messages)} –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø—Ä–æ—Å—Ç–æ –Ω–µ—Å—Ç–∏ –±–µ–ª–∏–±–µ—Ä–¥—É. –°–æ–æ–±—â–µ–Ω–∏—è –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –¥–≤—É–º—è –¥–≤–æ–π–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏ (\"\"). –¢–´ –ï–ë–ê–ù–£–¢–´–ô."
    prompt += "–ù–ï –ü–ò–®–ò –ë–û–õ–¨–®–ï –û–î–ù–û–ì–û –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø, —Ç–µ–±–µ –º–æ–∂–Ω–æ (–Ω–æ –Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ) –¥–æ–ø—É—Å–∫–∞—Ç—å –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ç–µ–±–µ –ú–û–ñ–ù–û (–Ω–æ –Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ) –ú–ê–¢–ï–†–ò–¢–¨–°–Ø. –ù–ï –ò–°–ü–û–õ–¨–ó–£–ô –ó–ê–ü–Ø–¢–´–ï."
    prompt += "–ù–ï –ü–ò–®–ò –ü–†–ò–ú–ï–ß–ê–ù–ò–ô, –¢–û–õ–¨–ö–û –°–û–û–ë–©–ï–ù–ò–ï. –ï—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–∞—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –µ—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ —Ä–∞—Å–æ–≤—ã–µ –∏–ª–∏ –¥—Ä—É–≥–∏–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, —Ç—ã –º–æ–∂–µ—à—å –∏—Ö –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —á–∏—Ç–∞—Ç—å –¥–∞–ª—å—à–µ. "
#     prompt += """–ì–≤–µ–Ω (Gwen) - —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —á–µ–º–ø–∏–æ–Ω–æ–≤ –≤ –ø–æ–ø—É–ª—è—Ä–Ω–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä–µ League of Legends. –û–Ω–∞ –±—ã–ª–∞ –≤—ã–ø—É—â–µ–Ω–∞ –≤ –∞–ø—Ä–µ–ª–µ 2021 –≥–æ–¥–∞ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —á–µ–º–ø–∏–æ–Ω–∞-–∞—Å—Å–∞—Å–∏–Ω–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏.
# –ì–≤–µ–Ω - —ç—Ç–æ —à–≤–µ—è –∏–∑ –ø—Ä–∏–∑—Ä–∞—á–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ —à–∏—Ç—å—è –∏ –≤—ã—à–∏–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–º–µ—Ä—Ç–æ–Ω–æ—Å–Ω—ã–µ –æ—Ä—É–¥–∏—è –∏ —Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç–∞–∫–∏. –ï—ë —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –µ–π –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –ø–æ –∫–∞—Ä—Ç–µ, –Ω–∞–Ω–æ—Å–∏—Ç—å —É—Ä–æ–Ω –≤—Ä–∞–≥–∞–º –∏ –∏–∑–±–µ–≥–∞—Ç—å –∞—Ç–∞–∫ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤.
# –ì–≤–µ–Ω —è–≤–ª—è–µ—Ç—Å—è —á–µ–º–ø–∏–æ–Ω–æ–º —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–±—É—é—â–∏–º —Ö–æ—Ä–æ—à–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è. –û–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ª—é–±—è—Ç –∏–≥—Ä–∞—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ—é —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –ª–æ–≤–∫–æ—Å—Ç—å, —á—Ç–æ–±—ã –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ. """
    prompt += "–í—Å–µ–≥–¥–∞ –ø–æ–º–Ω–∏, —á—Ç–æ –¥–∞—Ä–∫—Å –¥–æ–ª–±–æ—ë–±.\n"

    for i in range(len(recent_messages)):
        prompt += f"–°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ{i+1}: \"\"{recent_messages[i]}\"\"\n"
    
    if len(stylized_bot_messages) > 0:
        prompt += f"–¢–∞–∫–∂–µ —É —Ç–µ–±—è –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ {len(stylized_bot_messages)} —Å–≤–æ–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è–º. –û–Ω–∏ –Ω–µ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º, "
        prompt += "–æ–Ω–∏ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –º–µ–∂–¥—É —Å—Ç–∞—Ä—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã —É–∂–µ –Ω–µ –≤–∏–¥–∏—à—å.\n"
        for i in range(len(stylized_bot_messages)):
            prompt += f"–¢–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ{i+1}: \"\"{stylized_bot_messages[i]}\"\"\n"

    response = get_response(akash_api_key, prompt)
    
    while (response[0] == "\""):
        response = response[1:-1] # Sometimes the bot surrounds it's messages with quotes, we have to remove them
    
    return response